<section class="home px-20">
    <h1>Gerador de orçamentos</h1>

    <div class="mt-10">
        <app-alert
            [showAlert]="alertOptions.showAlert"
            [icon]="alertOptions.icon"
            [title]="alertOptions.title"
            [text]="alertOptions.text"
            [showCloseButton]="alertOptions.showCloseButton"
            [variant]="alertOptions.variant"
            (closeAlert)="handleAlertEvent()"
        ></app-alert>
    </div>

    <article class="home__form">
        <form class="home__form__veiculo" [formGroup]="veiculoForm">
            <h2>Dados do veículo</h2>
            <div class="home__form__veiculo__wrapper">
                <mat-form-field>
                    <mat-label>Proprietário</mat-label>
                    <input matInput formControlName="proprietario" />
                    <mat-error *ngIf="veiculoForm.get('proprietario')?.touched && veiculoForm.get('proprietario')?.hasError('required')">
                        Proprietário é obrigatório!
                    </mat-error>
                </mat-form-field>

                <mat-form-field>
                    <mat-label>Placa</mat-label>
                    <input matInput formControlName="placa" />
                    <mat-error *ngIf="veiculoForm.get('placa')?.touched && veiculoForm.get('placa')?.hasError('required')"> Placa é obrigatório! </mat-error>
                </mat-form-field>

                <mat-form-field>
                    <mat-label>Marca</mat-label>
                    <input matInput formControlName="marca" />
                    <mat-error *ngIf="veiculoForm.get('marca')?.touched && veiculoForm.get('marca')?.hasError('required')"> Marca é obrigatório! </mat-error>
                </mat-form-field>
            </div>
        </form>

        <form class="home__form__servicos" [formGroup]="servicoForm">
            <h2>Serviços</h2>
            <div class="home__form__servicos__wrapper">
                <mat-chip-listbox *ngIf="tipoServicos.length" aria-label="serviços">
                    <mat-chip-option *ngFor="let servico of tipoServicos" (click)="setTipoServico(servico)">{{ getJobName(servico) }}</mat-chip-option>
                </mat-chip-listbox>

                <mat-form-field>
                    <mat-label>Descrição</mat-label>
                    <textarea matInput formControlName="descricao"></textarea>
                    <mat-error *ngIf="servicoForm.get('descricao')?.touched && servicoForm.get('descricao')?.hasError('required')">
                        descrição é obrigatório!
                    </mat-error>
                </mat-form-field>

                <mat-form-field floatLabel="always">
                    <mat-label>Valor</mat-label>
                    <input matInput type="number" formControlName="valor" placeholder="0,00" step="0.01" />
                    <span matTextPrefix>R$&nbsp;</span>
                    <mat-error *ngIf="servicoForm.get('valor')?.touched && servicoForm.get('valor')?.hasError('required')">Valor é obrigatório!</mat-error>
                </mat-form-field>

                <button mat-raised-button color="primary" (click)="addJob()" [disabled]="servicoForm.invalid || !tipoServico">adicionar serviço</button>
            </div>
        </form>
    </article>

    <div *ngIf="servicos['funilaria'].length > 0">
        <app-job-summary [jobs]="servicos['funilaria']" title="funilaria"></app-job-summary>
    </div>
</section>
